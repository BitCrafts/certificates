@*// SPDX-License-Identifier: AGPL-3.0-only
// Copyright (C) 2025 Younes Benmoussa <benzsoftware@pm.me>
// 
// This program is free software: you can redistribute it and/or modify it under the terms of the GNU Affero General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
// This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more details.
// You should have received a copy of the GNU Affero General Public License along with this program. If not, see <https://www.gnu.org/licenses/>. 
*@

@model BitCrafts.Certificates.Application.DTOs.CertificateDto
@{
    ViewData["Title"] = $"Certificate #{Model.Id}";
}

<h1>Client Certificate Details</h1>

<div class="mb-3">
    <a class="btn btn-outline-secondary" asp-action="Index">Back to list</a>
    <a class="btn btn-outline-secondary ms-2" asp-controller="Servers" asp-action="Index">Servers</a>
    <a class="btn btn-outline-secondary ms-2" asp-controller="Home" asp-action="Index">Home</a>
    </div>

<dl class="row">
    <dt class="col-sm-3">ID</dt>
    <dd class="col-sm-9">@Model.Id</dd>

    <dt class="col-sm-3">Kind</dt>
    <dd class="col-sm-9">@Model.Kind</dd>

    <dt class="col-sm-3">Subject</dt>
    <dd class="col-sm-9">@Model.Subject</dd>

    @if (!string.IsNullOrEmpty(Model.SanEmail))
    {
        <dt class="col-sm-3">Email SAN</dt>
        <dd class="col-sm-9">@Model.SanEmail</dd>
    }

    @if (!string.IsNullOrEmpty(Model.SanDns))
    {
        <dt class="col-sm-3">DNS SAN</dt>
        <dd class="col-sm-9">@Model.SanDns</dd>
    }

    <dt class="col-sm-3">Serial Number</dt>
    <dd class="col-sm-9">@Model.SerialNumber</dd>

    <dt class="col-sm-3">Thumbprint</dt>
    <dd class="col-sm-9"><code>@Model.Thumbprint</code></dd>

    <dt class="col-sm-3">Not Before</dt>
    <dd class="col-sm-9">@Model.NotBefore.ToString("yyyy-MM-dd HH:mm:ss")</dd>

    <dt class="col-sm-3">Not After</dt>
    <dd class="col-sm-9">@Model.NotAfter.ToString("yyyy-MM-dd HH:mm:ss")</dd>

    <dt class="col-sm-3">Issued At</dt>
    <dd class="col-sm-9">@Model.IssuedAt.ToString("yyyy-MM-dd HH:mm:ss")</dd>

    <dt class="col-sm-3">Status</dt>
    <dd class="col-sm-9"><span class="badge @(Model.IsRevoked ? "bg-danger" : "bg-success")">@Model.Status</span></dd>
</dl>

<div class="mt-3">
    <a class="btn btn-outline-primary" asp-action="Index">Back</a>
    @if (!Model.IsRevoked)
    {
        <a class="btn btn-outline-danger ms-2" asp-action="Revoke" asp-route-id="@Model.Id">Revokeâ€¦</a>
    }
</div>
